---
import { BACKEND_URL } from "astro:env/client";
import { EmailCaptureForm, OptimizedPicture } from "@cvix/astro-ui";
import { DEFAULT_LOCALE, type Lang, LOCALES } from "@cvix/i18n/astro";
import { useTranslations } from "@/i18n/i18n";

const astroLocale = Astro.currentLocale;
let langToUse: Lang;

let locale = astroLocale as Lang;
if (astroLocale && LOCALES[locale]) {
	langToUse = locale;
} else {
	langToUse = DEFAULT_LOCALE;
}
const t = useTranslations(langToUse);

import CvixSystemImage from "@cvix/assets/images/cvix-system.png";
---

<section class="pt-32 pb-16 md:pt-48 md:pb-32 bg-background overflow-hidden fade-in-section">
  <div class="container mx-auto max-w-7xl px-4 text-center">
    <div
      class="inline-flex items-center rounded-full border border-primary/20 bg-primary/5 px-3 py-1 text-sm font-medium text-primary mb-8 fade-in-section delay-100"
    >
      <span class="flex h-2 w-2 rounded-full bg-green-500 mr-2 animate-pulse"></span>
      {t("hero.badge.text")}
    </div>

    <h1
      class="mx-auto mb-6 max-w-4xl text-5xl font-serif font-bold tracking-tight text-foreground sm:text-6xl md:text-7xl leading-[1.1] fade-in-section delay-200"
    >
      {t("hero.title")}
    </h1>

    <p
      class="mx-auto mb-4 max-w-2xl text-lg text-muted-foreground md:text-xl fade-in-section delay-300"
    >
      {t("hero.subtitle")}
    </p>

    <p
      class="mx-auto mb-10 max-w-2xl text-base text-primary font-medium fade-in-section delay-350"
    >
      {t("hero.earlyAccess")}
    </p>

    <!-- Waitlist Form -->
    <div
      id="hero-waitlist"
      class="flex flex-col items-center justify-center gap-4 mb-16 fade-in-section delay-400"
    >
      <div class="w-full max-w-md">
        <EmailCaptureForm
          apiUrl={`${BACKEND_URL}/api/waitlist`}
          emailPlaceholder={t("hero.email.placeholder")}
          buttonText={t("hero.email.button")}
          successMessage={t("hero.email.success")}
          errorMessage={t("hero.email.error")}
          rateLimitMessage={t("hero.email.rateLimit")}
          source="hero-waitlist"
          class="mx-auto max-w-md"
        />
      </div>
      <p class="text-sm text-muted-foreground">
        {t("hero.email.privacy")}
      </p>
    </div>

    <div class="relative mx-auto max-w-5xl fade-in-section delay-500">
      <OptimizedPicture
        src={CvixSystemImage}
        alt={t("hero.mockup.alt")}
        class="relative mx-auto w-full"
      />
    </div>
  </div>
</section>
