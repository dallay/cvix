---
import { CVIX_API_URL } from "astro:env/client";
import { EmailCaptureForm } from "@cvix/astro-ui";
import { cn } from "@cvix/lib";
import type { HTMLAttributes } from "astro/types";
import { type Lang, useTranslations } from "@/i18n/i18n.ts";

interface Props extends HTMLAttributes<"section"> {
	title?: string;
	description?: string;
	formId?: string;
}

const { title, description, formId, ...attrs } = Astro.props as Props;
const currentLocale = Astro.currentLocale as Lang;
const t = useTranslations(currentLocale);
---

<section
	class={cn(
		"flex w-full will-change-transform",
		attrs.class
	)}
	id={formId}
	{...attrs}
>
	<div
		class={cn(
			"flex py-5 px-0",
			"transition-colors duration-350 ease-in-out w-full"
		)}
	>
		<div class="flex gap-5 mx-auto w-full">
			<div class="flex flex-col w-full max-w-4xl">
				<h1
					class={cn(
						"text-gray-900 dark:text-white text-3xl @md:text-5xl font-bold leading-tight tracking-tight relative",
						"transition-colors duration-350 animate-fadeIn font-heading"
					)}
				>
					{title || t({
            en: "Join the ProfileTailors Waitlist",
            es: "Únete a la lista de espera de ProfileTailors",
          })}
				</h1>
				<p
					class={cn(
						"text-gray-900 dark:text-white relative mt-2 text-base font-medium tracking-wide leading-relaxed",
						"animate-fadeIn animation-delay-150"
					)}
				>
					{description || t({
            en: "Sign up to be the first to know when ProfileTailors is available and receive exclusive updates.",
            es: "Regístrate para ser el primero en saber cuándo ProfileTailors estará disponible y recibir actualizaciones exclusivas.",
          })}
				</p>
				<div class="flex mt-6 w-full">
					<EmailCaptureForm apiUrl={`${CVIX_API_URL}/api/waitlist`}
						emailPlaceholder={t({
							en: "Enter your email",
							es: "Ingresa tu correo electrónico",
						})}
						buttonText={t({
							en: "Join the waitlist",
							es: "Únete a la lista de espera",
						})}
						successMessage={t({
							en: "Successfully joined the waitlist!",
							es: "¡Te has unido a la lista de espera!",
						})}
						errorMessage={t({
							en: "Failed to join. Please try again.",
							es: "Error al unirse. Por favor intenta de nuevo.",
						})}
						rateLimitMessage={t({
							en: "Too many requests. Please wait.",
							es: "Demasiadas solicitudes. Por favor espera.",
						})}
						source="landing-cta"
					/>
				</div>
			</div>
		</div>
	</div>
</section>
