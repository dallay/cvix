# IMPORTANT: Environment Variable Files Overview
#
#
# **Canonical variable list:**
#   - The authoritative list of all required and optional environment variables is maintained in the project documentation.
#   - See: `docs/` site or the main README for details and explanations of each variable.
#
# Copy this file to `.env` and replace placeholders with real values for your environment.
# Do NOT commit any real secrets or credentials. Use secret stores for production.

# ----------------------------
# Docker / Compose / Local Build
# ----------------------------
COMPOSE_PATH_SEPARATOR=:
COMPOSE_FILE=postgresql-compose.yml:docker-compose.yml
# ----------------------------
# General / App URLs (New Semantic Naming)
# ----------------------------
# Application identifiers and base URLs used across services and frontends
APP_NAME=ProFileTailors
HOSTNAME=localhost

# ============================================================================
# NEW SEMANTIC NAMING - Use these for all new code
# ============================================================================
#
# IMPORTANT: Use the SAME variable names for all environments.
# The system automatically detects the environment (local/production) and uses appropriate defaults.
#
# For LOCAL development:
#   - These variables are OPTIONAL (fallback to defaults shown below)
#   - Only override if you need different values
#
# For PRODUCTION (Cloudflare Pages, Vercel, Netlify):
#   - Set these SAME variable names with production URLs
#   - Example: CVIX_MARKETING_URL=https://profiletailors.com
#
# DO NOT use _PROD, _DEV, or _LOCAL suffixes - the system handles environment detection automatically.
# ============================================================================

# Marketing/Landing page (Astro)
# Default: http://localhost:7766
# Production example: https://profiletailors.com
CVIX_MARKETING_URL=http://localhost:7766

# Main web application (Vue SPA)
# Default: http://localhost:9876
# Production example: https://app.profiletailors.com
CVIX_WEBAPP_URL=http://localhost:9876

# Documentation site
# Default: http://localhost:4321
# Production example: https://docs.profiletailors.com
CVIX_DOCS_URL=http://localhost:4321

# Blog site
# Default: http://localhost:7767
# Production example: https://blog.profiletailors.com
CVIX_BLOG_URL=http://localhost:7767

# Backend REST API
# Default: https://localhost:8443
# Production example: https://api.profiletailors.com
CVIX_API_URL=https://localhost:8443

# OAuth/Keycloak server
# Default: http://localhost:9080
# Production example: https://auth.profiletailors.com
CVIX_OAUTH_URL=http://localhost:9080

# Contact system endpoint (for contact form submissions)
# Default: https://your.contact.system/api/contact
# Production example: https://contact.profiletailors.com/api/contact
CVIX_CONTACT_URL=https://your.contact.system/api/contact

# hCaptcha site key for frontend CAPTCHA integration
# Default: your-hcaptcha-site-key
# Production example: your-production-hcaptcha-site-key
CVIX_HCAPTCHA_SITE_KEY=your-hcaptcha-site-key

# ----------------------------
# Database (PostgreSQL)
# ----------------------------
# R2DBC URL for reactive database operations
DATABASE_URL=r2dbc:postgresql://postgresql:5432/cvix
# JDBC URL for Liquibase migrations (Dual Driver Strategy)
# Liquibase requires traditional JDBC driver, not R2DBC
LIQUIBASE_URL=jdbc:postgresql://postgresql:5432/cvix
# The application may source the username/password from POSTGRESQL_* vars below.
DATABASE_USERNAME="${POSTGRESQL_USER}"
DATABASE_PASSWORD="${POSTGRESQL_PASSWORD}"

# Container-local postgres credentials (development only)
POSTGRESQL_USER=postgres
POSTGRESQL_PASSWORD=postgres
POSTGRESQL_DB=postgres
POSTGRESQL_VERSION=16.9-alpine

# ----------------------------
# Keycloak / Authentication
# ----------------------------
# Hostnames and admin credentials used by local Keycloak and integration helpers.
# These values are examples only. Do NOT use real admin passwords in VCS.
KEYCLOAK_URL=localhost
KC_HOSTNAME=localhost
KEYCLOAK_VERSION=26.2.3
KC_HTTP_PORT=6080
KC_HTTPS_PORT=6443

REALM=your-realm
CLIENT_ID=your-client-id
CLIENT_SECRET=your-client-secret

# Keycloak admin user used for test and local setup (example values)
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=secret

# Admin/realm settings referenced by server/engine/application.yml
ADMIN_CLIENT_ID=admin-cli
ADMIN_REALM=master
ADMIN_REALM_USERNAME=admin
# Replace with a secure password in your deploy environment (not checked-in)
ADMIN_REALM_PASSWORD=your-admin-password

# ----------------------------
# CORS (server configuration)
# ----------------------------
# These are used by server/engine/src/main/resources/application.yml if set.
# Provide comma-separated lists where applicable.
CORS_ALLOWED_ORIGINS=http://localhost:5173,https://app.example.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Authorization,Content-Type,Accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers,X-Requested-With,X-Xsrf-Token,X-New-Header
CORS_EXPOSED_HEADERS=Access-Control-Allow-Origin,Access-Control-Allow-Credentials
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# ----------------------------
# Content Security Policy (CSP) - Frontend
# ----------------------------
# These are used by the webapp Caddy container for CSP headers.
# CSP_CONNECT_SRC: Allowed origins for fetch/XHR/WebSocket connections.
#   Include 'self', your backend API URL, and auth provider (Keycloak).
#   Example: 'self' https://api.example.com https://auth.example.com
# CSP_OBJECT_SRC: Allowed sources for <object>, <embed>, <applet> elements.
#   Use 'self' blob: to allow PDF preview with blob URLs, or 'none' for strict security.
CSP_SCRIPT_SRC="'self' 'unsafe-inline'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"
CSP_CONNECT_SRC="'self' https://api.example.com https://auth.example.com"
CSP_OBJECT_SRC="'self' blob:"

# ----------------------------
# Service Versions & Helpers
# ----------------------------
GREENMAIL_VERSION=2.0.0

# ----------------------------
# SSL / Keystore (example)
# ----------------------------
# Used by local dev scripts that build or use an application keystore
# You should replace the password with a secure value: openssl rand -base64 32
SSL_KEYSTORE_PASSWORD="changeit"
SSL_KEY_ALIAS=ProFileTailors
SSL_KEYSTORE_LOCATION=file:infra/ssl/keystore.jks

# ----------------------------
# Tokens & External Keys (DO NOT COMMIT REAL SECRETS)
# ----------------------------
# Replace with secure values via secret manager or CI env. These placeholders are examples only.
SENDGRID_API_KEY=YOUR_API_KEY

# ----------------------------
# PDF Generation (resume/document rendering)
# ----------------------------
# Docker image for PDF generation (texlive recommended)
PDF_DOCKER_IMAGE=ghcr.io/dallay/texlive:2025
# Max concurrent PDF containers (default: 10)
PDF_MAX_CONCURRENT_CONTAINERS=10
# PDF generation timeout in seconds (default: 30)
PDF_TIMEOUT_SECONDS=30
# PDF container memory limit in MB (default: 512)
PDF_MEMORY_LIMIT_MB=512
# PDF container CPU quota (default: 0.5)
PDF_CPU_QUOTA=0.5
# ----------------------------
# Development-only toggles
# ----------------------------
# Some flags are only used for local/test convenience
# Set to true to persist LaTeX build artifacts (dev only)
PERSIST_LATEX_FILES=false

# Spring profile used by the backend (dev/test/prod)
SPRING_PROFILES_ACTIVE=dev

# SMTP Configuration for Development
SMTP_HOST=localhost
SMTP_PORT=3025
SMTP_USERNAME=developer
SMTP_PASSWORD=secret
SMTP_FROM_EMAIL=noreply@cvix.local
SMTP_FROM_NAME="ProFileTailors Development"

# ----------------------------
# Notes & Next Steps
# ----------------------------
# - Keep `.env` out of version control. Add it to `.gitignore` if not already ignored.
# - For production, load secrets from a secret manager (Vault, AWS Secrets Manager, GitHub Secrets, etc.).
# - The marketing frontend has its own `.env.example` at: client/apps/marketing/.env.example
# - If you want, I can add a short README snippet showing how to safely create `.env` files per-environment.

# Resume Template Configuration
# Template source types (in order of priority - first wins on ID conflicts)
# Free tier: [CLASSPATH]
# Premium tier: [FILESYSTEM, CLASSPATH]
# Local filesystem path for resume templates (used if FILESYSTEM is in TEMPLATE_SOURCE_TYPES)
TEMPLATE_SOURCE_PATH=/path/to/your/local/templates/resume
TEMPLATE_SOURCE_TYPES="CLASSPATH,FILESYSTEM"

# ----------------------------
# Waitlist / Privacy
# ----------------------------
# Secret key for HMAC-SHA256 IP hashing. Must be kept secret.
# In production, use a long random string (e.g., 64 chars hex).
# Generate one with: openssl rand -hex 32
WAITLIST_IP_HMAC_SECRET=your-secure-random-secret-here

# ----------------------------
# Contact Form (Backend Integration)
# ----------------------------
# Backend contact form integration with a workflow endpoint and hCaptcha validation.
# The backend validates hCaptcha server-side (prevents API key exposure in frontend).
#
# CONTACT_WEBHOOK_URL: Full URL to your contact workflow webhook endpoint
# Example: https://automation.example.com/webhook/contact
CONTACT_WEBHOOK_URL=https://n8n.automation.nullish.homes/webhook-test/v1/contact

# CONTACT_API_KEY: Header Auth credential for the webhook (x-api-key header)
# Obtain from your workflow system's credentials or header configuration
CONTACT_API_KEY=your-header-auth-credential

# CONTACT_FORM_TOKEN_ID: Domain-specific validation token (form-token-id header)
# Obtain from your workflow system's form node or headers configuration
CONTACT_FORM_TOKEN_ID=your-form-token-id


# hCaptcha Site Key: Client-side site key
# Get from: https://dashboard.hcaptcha.com → Settings → Site Key
# Test key (always passes): 10000000-ffff-ffff-ffff-000000000000
HCAPTCHA_SITE_KEY=4454e8b2-b86e-44b0-b956-717cffe82218

# HCAPTCHA_SECRET_KEY: Server-side validation key
# Get from: https://dashboard.hcaptcha.com → Settings → Secret Key
# Test key (always passes): 0x0000000000000000000000000000000000000000
HCAPTCHA_SECRET_KEY=0x0000000000000000000000000000000000000000
